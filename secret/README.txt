- AES加密，块大小必须为128位（16字节），如果不是，则要补齐，密钥长度可以选择128位、192位、256位。

密钥请求报文:

密钥传输报文:

加密解密过程在本地进行,使用AES,
密钥协商:AES的密钥
如何加密传输AES密钥: 使用RSA加密AES的密钥

密钥协商过程:
A->B
1.A使用AES加密,生成AES密钥AESK_A,使用B的RSA公钥PubK_B加密,
2.B使用私钥PriK_B解密,得到AESK_A,使用AES_K解密数据

服务器数据库中保存所有节点的RSA公钥

A请求服务器,如何保证确实是A请求服务器,而不是C的伪造?
密钥请求报文
A->服务器时, 将自己的ID用RSA_PriK_A加密,添加入请求报文,
服务器先使用PubK_A解密,看ID是否是A(模拟数字签名)

密钥协商报文:
A的协商报文中给服务器A的公钥








 
